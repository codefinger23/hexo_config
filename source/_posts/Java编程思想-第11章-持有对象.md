---
title: Java编程思想 第11章 持有对象
date: 2017-11-26 19:54:20
tags: [读书笔记, Java编程思想]
---
> 如果一个程序只包含固定数量且其生命期都是已知的对象，那么这是一个非常简单的程序。

## 范型和类型安全容器

使用Java SE5之前的容器的一个主要问题就是编译器允许向容器中插入不正确的类型。如果在容器中放入了错误的类型，将会导致运行时错误。因此引入了范型的概念，用来创造类型安全的容器，因为这样的容器只包含一种类型的，所以不会一般不会导致类型错误。

## 基本概念

Java容器类类库的用途是保存对象，并将其划分为两个不同的概念：

1. Collection。一个独立元素的序列，这些元素都服从一条或多条规则。List必须按照插入的顺序保存元素，而Set不能有重复元素。Queue按照队列规则来确定对象产生的顺序。
2. Map。一组成对的键值对对象，允许使用键来查找值。ArrayList允许使用数字来查找值，因此在某种意义上将，它将数字与对象关联了一起。映射表允许使用另一个对象来查找某个对象，它也被称为关联数组，因为它将某些对象与另外一些对象关联在了一起；或者被称为字典，因为可以使用键对象来查找值对象，就像在字典中使用单词来定义一样。Map是强大的编程工具。

## 添加一组元素

在java.util包中的Arrays和Collections类中都有很多使用方法，可以在一个Collection中添加一组元素。Arrays.asList方法接受一个数组或是一个用逗号分隔的元素列表。可以在Arrays.asList中间插入一条线索，以告诉编译器对于由Arrays.asList产生的List类型，实际的目标类型应该是什么。这称为显示类型参数说明。

## 容器的打印

打印容器一般会调用容器保存对象的toString方法，打印容器也无需任何帮助。

## List

List承诺可以将元素维护在特定的序列中。List接口在Collection的基础上添加了大量的方法，使得可以在List的中间插入和移除元素。有两种类型的List：

- 基本的ArrayList，它长于随机访问元素，但是在List的中间插入和移除元素时较慢。
- LinkedList，它通过代价较低的在List中间进行的插入和删除操作，提供了优化的顺序访问。LinkedList在随机访问方面相对比较慢，但是它的特性集较ArrayList更大。

## 迭代器

任何容器类，都必须有某种方式可以插入元素并将它们再次取回。迭代器是一个对象，他的工作是遍历并选择序列中的对象，而客户端程序员不必知道或关心该序列底层的结构。此外，迭代器通常被称为轻量级对象：创建它的代价小。因此，经常可以见到对迭代器有些奇怪的限制；例如Java的Iterator只能单向移动。

## LinkedList

LinkedList也像ArrayList一样实现了基本的List接口，但是它执行某些操作时比ArrayList更高效，但在随机访问操作方面却要逊色一些。

## Stack

栈通常是指后进先出的容器。有时栈也被称为叠加栈，因为最后压入栈的元素，第一个弹出栈。

## Set

Set不保存重复的元素。如果试图将相同对象的过个实例添加到Set中，那么它就会组织这种重复现象。Set中最常被使用的是测试归属性，可以很容易地询问某个对象是否在某个Set中。正因如此，查找就成为了Set中最重要的操作，因此通常都会选择一个HashSet的实现，它专门对快速查找进行优化。

## Map

将对象映射到其他对象的能力是一种解决编程问题的杀手锏。Map与数组和其他Collection一样，可以很容易地扩展到多维，因此可以很容易地将容器组合起来从而快速地生成强大的数据结构。

## Queue

队列是一个典型的先进先出的容器。即从容器的一端放入事物，从另一端去除，并且事物放入容器的顺序与取出的顺序是相同的。队列常被当作一种可靠的将对象从程序的某个区域传输到另一个区域的途径。队列在并发编程中特别重要，因为它们可以安全地将对象从一个任务传输给另一个任务。

先进先出描述了最典型的队列规则。队列规则是指在给定一组队列中的元素的情况下，确定下一个弹出队列的元素的规则。先进先出声明的是下一个元素应该是等待时间最长的元素。优先级队列声明下一个弹出元素是最需要的元素。

## Collection和Iterator

Collection是描述所有序列容器的共性的根接口，它可能会被认为是一个附属接口，即因为要表示其他若干个接口的共性而出现的接口。在Java中，使用迭代器而不是Collection来表示容器之间的共性。

## Foreach与迭代器

能够与foreach一起工作是所有Collection对象的特性。之所以能够工作，是因为Java SE5引入了新的被称为Iterable的接口，该接口包含一个能够产生Iterator的iterator方法，并且Iterable接口被foreach用来在序列中移动。

## 总结

Java提供了大量持有对象的方式：

1. 数组将数字和对象关联起来。
2. Collection保存单一的元素，而Map保存相关联的键值对。
3. 像数组一样，List也奖励数字索引与对象的关联，因此，数组和List都是排好序的容器。List能够自动扩容。
4. 如果要进行大量的随机访问，就使用ArrayList；如果要经常从表中间插入或删除元素，则应该使用LinkedList。
5. 各种Queue以及栈的行为，由LinkedList提供支持。
6. Map是一种将对象与对象相关联的设计。
7. Set不接受重复元素。
8. 新程序中不应该使用过时的Vector、Hashtable和Stack。