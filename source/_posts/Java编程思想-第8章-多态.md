---
title: Java编程思想 第8章 多态
date: 2017-11-23 22:15:11
tags: [读书笔记, Java编程思想]
---
> “我曾经被问到‘求教，Babbage先生，如果你向机器中输入错误的数字，可以得到正确的答案吗？’ 我无法恰当地理解产生这种问题的概念上的混淆” ——Charles Babbage(1791-1871)
在面向对象的程序设计语言中，多态是继数据抽象和继承之后的第三种基本特征。

## 再论向上转型

在第7章中我们已经知道，对象既可以作为它自己本身的类型使用，也可以作为它的基类型使用。而这种把某个对象的引用视为对其基类型的引用的做法称作向上转型——因为在继承树的画法，基类是放置在上方的。

## 转机

- 方法调用绑定：将一个方法调用同一个方法主体关联起来被称作绑定。若在程序执行前进行绑定，叫做前期绑定。这是面向过程的语言中不需要选择就默认的绑定方式。但是Java采用的是后期绑定，它的含义就是在运行时根据对象的类型进行绑定。后期绑定也叫做动态绑定或运行时绑定。
- 产生正确的行为：一旦知道Java中所有方法都是通过动态绑定实现多态这个事实后，我们就可以编写只与基类打交道的程序代码了，并且这些代码对所有的导出类都可以正确运行。或者换一种说法，发送消息给某个对象，让该对象去断定应该做什么事。
- 可扩展性：在一个设计良好的OOP程序中，大多数或所有的方法都应该只与基类接口通信。这样的程序是可扩展的，因为可以从通用的基类继承出新的数据类型，从而新添加一些功能。那些操纵基类接口的方法不需要任何改动就可以应用于新类。
- 缺陷：覆盖私有方法：只有非private方法才可以被覆盖。
- 缺陷：域与静态方法：任何域访问操作都将由编译器解析，因此不是多态的。静态方法是与类，而非与单个的对象相关联的。

## 构造器和多态

- 构造器的调用顺序：1.调用基类构造器-这个步骤会不断地反复递归下去，首先是构造这种层次结构的根，然后是下一层导出类，知道最底层的导出类；2.按声明顺序调用成员初始化方法；3.调用导出类构造器的主体。
- 继承与清理：通过组合和继承方法来创建新类时，永远不必担心对象的清理问题，子对象通常都会留给垃圾回收器进行处理。
- 构造器内部的多态方法的行为：初始化的实际过程是：1.在其他任何事物发生之前，将分配对象的存储空间初始化成二进制的零；2.调用基类构造器；3.按照声明的顺序调用成员的初始化方法。4.调用导出类的构造器主体。

## 协变返回类型

Java SE5中添加了协变返回类型，它表示在导出类中的被覆盖方法可以返回基类方法的返回类型的某种导出类型。

## 用继承进行设计

学习了多态之后，看起来似乎所有东西都可以被继承，因为多态是一种如此巧妙的工具。事实上，当我们使用现成的类来建立新类时，如果首先考虑使用继承技术，反倒会加重我们的设计负担，使事情变得不必要地复杂起来。

## 总结

多态意味着“不同的形式”。在面向对象的程序设计中，我们持有从基类继承而来的相同接口，以及使用该接口的不同形式：不同版本的动态绑定方法。