---
title: JS高程 第五章 引用类型
date: 2017-10-19 22:09:31
tags: [读书笔记, JavaScript高级程序设计]
---
> 本章介绍了大量的JavaScript内置的引用类型，并描述了它们的特性与使用方法。
<!--more-->
## Object 类型

Object 类型在JavaScript是最为常用的引用类型，在使用过程中可以用类的概念来理解，但是，引用类型和类又有着区别，为了区别引用类型和类，本书中都会使用引用类型来表示

实例化Object 类型可以使用两种方式，一种是利用new关键字，一种是字面量，这两种都可以生成Object实例。

```
var person = new Object() //利用new关键字实例化引用类型
var person = {} //利用空的字面量实例化引用类型
```

利用空字面量实例化引用类型和new关键字效果相同，一般推荐使用字面量进行实例化，看起来有一种封装数据的效果。

Obect属性的访问可以通过.运算符和[]运算符进行访问，正常的使用方式是通过.运算符，但是当属性名包含特殊字符，如空格时，就需要使用[]运算符来进行访问，而且还可以通过变量访问属性，功能比较强大。

## Array类型

Array类型是除了Object类型在JavaScript第二常用的类型，Array类型在JavaScript可以完成很多功能。和其他面向对象的语言不通在于，Array类型可以存储任何类型变量，如number,string等，可以存储在同一个Array变量中，可以通过new关键字和字面量来进行初始化。

- 自动扩容：Array类型在内存中是连续的存储的，当存储超过一定限度，JavaScript就会对该对象进行扩容，增加其容量。
- 常量取长度：Array类型有length属性，存储数组的长度，也可以通过控制length来控制Array的容量。

### 检测数组

一般情况下可以通过instance运算符来计算判断变量是否是数组，但是当涉及到多个执行环境时，由于不同执行环境对于Array的初始化可能存在区别，这是instance运算符可能无法准确判断出变量类型，为此ES5增加了Array.isArray()来判断是否是数组。

### 转换方法

Array内置了集中转换方法，将Array转换为字符串变量

- toLocalString() ：调用每一项的toLocalString方法，用逗号拼接到一起的字符串
- toString() : 调用每一项的toString()方法，用逗号拼接到一起的字符串
- valueOf() : 返回的还是数组，没有转换成字符串
- join() : 通过指定字符拼接各项而输出的字符串

> 如果数组中某一项是null或undefined的，通过上述方法调用，则以空字符串进行表示

### 栈方法

通过方法模拟栈的行为，达到后进先出(LIFO)的效果

- push() : 在数组最后添加元素
- pop() : 取得数组最后元素并移除元素

### 队列方法

通过方法模拟队列的邢薇，达到先进先出(FIFO)的效果

- push(): 在数组尾添加元素
- shift(): 获取数组头元素并移除元素

模拟一个向右滑动的队列

- pop(): 获取数组尾元素并移除
- unshift(): 在数组头添加元素

模拟一个向左滑动的队列

### 重排序方法

- sort(): 按字典序重新排列数组元素，会改变内存数据
- reverse(): 将数组元素逆序存储

sort() 方法可以自定义比较函数，通过函数变量传递即可

### 操作方法

- concat(): 接受数组或元素作为参数，将参数元素拼接到一起返回新的数组元素，不会改变内存数据。
- slice(): 接受1-2个位置参数，如果是1个，则返回从参数位置到数组尾的子串，如果两个，则返回所选位置的子串。
- splice(): 可以删除，插入，替换数组元素

### 迭代方法

- every(): 对数组每一个元素运行给定函数，如果函数每一项都返回true，则返回true。
- filter(): 对数组每一个元素运行给定函数, 返回该函数返回true的元素构成的数组。
- forEach(): 对数组每一个元素运行给定函数。这个方法没有返回值。
- map(): 对数组每一个元素运行给定函数，返回每一个函数返回值构成的数组。
- some(): 对数组每一个元素运行给定函数，如果函数任一项返回true则返回true。

### 归并方法

- reduce(): 从左至右按照指定方法合并数组元素
- reduceRight(): 从右至左按照指定方法合并数组元素

## Date 类型

JavaScript中用来显示时间的类型，基于java.util.Date类基础上构建。使用经过1970年1月1日零时开始经过的毫秒数来存储日期，即unix时间戳，可以通过内置方法，将字符串转化为具体的时间

## RegExp 类型

ECMAScript通过RegExp类型来支持正则表达式。使用类似Perl的语法可以穿件正则表达式。

```
var expression = / pattern / flags;
```
其中pattern部分可以是任意的正则表达式，flags标志位来表示正则表达式的行为

- g: 表示全局搜索
- i: 表示搜索忽略大小写
- m: 表示跨行匹配

## Function类型

函数在JavaScript中的存在是对象，而函数名就是执行这一对象的引用，基于此有两种定义函数的方法

```
function sum (a, b){
    return a+b;
}

var sum = function(a, b) {
    return a+b;
}
```

这两种定义函数的方式没有任何区别

在C语言中，函数会有声明和定义的区别，声明是说有这样一个函数可用，如果没有经过声明的函数是不可以直接使用的，定义就是函数的实现，而在JavaScript中没有声明和定义的区别，这是因为JavaScript的解析器会将函数声明放在执行器的最前面，也就是说，无论函数的位置如何，都可以在任何地方使用函数，当然要注意执行环境。

函数既然是一个引用，当然可以作为值传递，这一点赋予了JavaScript更加丰富多变的使用方式，可以简单理解为函数指针。

函数内置属性，可以增加使用的geek效果

- arguments： 函数的参数列表，前文已经有过描述
- callee(): 指向该函数实现，多见于函数解耦
- length： 函数期望的参数个数
- prototype: 该对象用来保存所有函数实现，引用类型继承也就是通过这个对象来实现。
- apply(): 在特定的执行环境执行函数，第一个参数是执行环境，第二个参数是参数列表。
- call(): 和appley相似的使用，区别在于参数的传递需要明确到每一个象征变量。

## 基本包装类型

- String: 对基本类型的引用类型包装，用于类型兼容
- Boolean：需要注意包装类型的Boolen变量，不再是通过值进行操作，再进行布尔表达式操作时，包装类型总是返回true，因为它是引用类型
- Number: 使用typeof 的结果和基本类型会有区别，其他包装类型也是相同

## 单体内置对象

JavaScript实现提供，不依赖宿主环境的对象，再程序执行前就已经存在。Object,Array,String等都属于内置对象，其他内置对象有

- Global 对象： 全局所有的对象都是Global的属性和方法，在浏览器中，一般由windows对象担任这一对象的实例。
>* encodeURI和encodeURIComponent用来转换字符串中出现的非法字符为其他编码，如空格转换成%20
>* decodeURI和decodeURIComponent用来将上述转换后的方法转换回原字符串
>* eval()方法相当于一个JavaScript解释器，可以将参数中的JavaScript代码执行，在使用过程中要相当小心。
- Math 对象： 存储常用的数学方法，如随机数，三角函数，对数等

## 小结

对象在JavaScript中被称为引用类型的值，因为引用类型和类有着实现上的区别，所以要和一般的面向对象语言区分来看，JavaScript提供了内置的的引用类型来创建特定的对象

- Object 基础类型，其他所有类型都继承了Obect的基本行为
- Array 类型是一组值得序列表，同时提供操作和转换这些值的功能
- Date 类型提供了有关日期和时间的信息，包括当前日期和时间以及相关计算功能
- RegExp 类型是ECMAScript支持正则的接口，提供了最基本的和一些高级的正则表达式功能
- 函数实际上也是对象，所以函数也具有方法来增强行为
- 基本类型可以通过基本包装类型来当作对象访问
- 每个包装类型都映射到同名的基本类型，但在使用上需要注意
- 在读取模式下访问基本类型值时，就会创建对应基本包装类型的一个对象，从而方便数据操作
- 在所有代码执行前，作用域中就已经存在Global和Math对象
- Global对象不能直接访问，但是windows对象一般承担了该角色
- Math对象提供了多种数学方法，用于辅助完成复杂的数学计算